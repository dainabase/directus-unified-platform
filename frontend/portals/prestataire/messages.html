<!doctype html>
<html lang="fr">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
    <meta http-equiv="X-UA-Compatible" content="ie=edge"/>
    <title>Messages & Communication - Espace Prestataire</title>
    
    <!-- CSS Tabler -->
    <link href="https://cdn.jsdelivr.net/npm/@tabler/core@latest/dist/css/tabler.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@tabler/core@latest/dist/css/tabler-flags.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@tabler/core@latest/dist/css/tabler-payments.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@tabler/core@latest/dist/css/tabler-vendors.min.css" rel="stylesheet">
    
    <!-- Tabler Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tabler/icons@latest/iconfont/tabler-icons.min.css">
    
    <!-- Custom CSS -->
    <link href="../assets/css/custom.css" rel="stylesheet">
    
    <style>
        [data-bs-theme="dark"] .hide-theme-dark { display: none !important; }
        [data-bs-theme="light"] .hide-theme-light { display: none !important; }
        
        /* JetBrains Mono pour les valeurs numériques */
        .badge-pill,
        .typing-speed,
        .file-size,
        .message-time {
            font-family: 'JetBrains Mono', monospace !important;
            font-weight: 600;
        }
        
        .chat-sidebar {
            height: calc(100vh - 140px);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .chat-list {
            overflow-y: auto;
            flex: 1;
        }
        
        .chat-item {
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .chat-item:hover {
            background: var(--tblr-bg-surface-secondary);
        }
        
        .chat-item.active {
            background: var(--tblr-green-lt);
            border-left: 3px solid var(--tblr-green);
        }
        
        .chat-container {
            height: calc(100vh - 140px);
        }
        
        .chat-messages {
            overflow-y: auto;
            scroll-behavior: smooth;
        }
        
        .chat-bubble {
            max-width: 70%;
        }
        
        .chat-bubble-content {
            background: var(--tblr-bg-surface-secondary);
            padding: 0.75rem 1rem;
            border-radius: 0.75rem;
            border-bottom-left-radius: 0.25rem;
        }
        
        .chat-bubble.me .chat-bubble-content {
            background: var(--tblr-green);
            color: white;
            border-bottom-left-radius: 0.75rem;
            border-bottom-right-radius: 0.25rem;
        }
        
        .chat-bubble-meta {
            margin-top: 0.25rem;
            font-size: 0.75rem;
        }
        
        .chat-date-divider {
            position: relative;
            text-align: center;
            margin: 2rem 0;
        }
        
        .chat-date-divider::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: var(--tblr-border-color);
            z-index: -1;
        }
        
        .chat-date-divider .badge {
            background: var(--tblr-bg-surface);
            padding: 0.25rem 1rem;
        }
        
        .typing-indicator {
            display: flex;
            align-items: center;
            opacity: 0.7;
        }
        
        .chat-attachment .card {
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .chat-attachment .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        textarea.form-control {
            resize: none;
            max-height: 120px;
        }
        
        .avatar-status {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 12px;
            height: 12px;
            border: 2px solid var(--tblr-bg-surface);
            border-radius: 50%;
        }
    </style>
</head>
<body data-bs-theme="light" class="layout-fluid role-prestataire">
    <div class="page">
        <!-- Navbar -->
        <header class="navbar navbar-expand-md navbar-light d-none d-lg-flex d-print-none">
            <div class="container-xl">
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar-menu">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="navbar-nav flex-row order-md-last">
                    <!-- Dark Mode Toggle -->
                    <div class="nav-item d-none d-md-flex me-3">
                        <div class="btn-list-item">
                            <a href="#" class="nav-link px-0 hide-theme-dark" title="Enable dark mode" data-bs-toggle="tooltip" data-bs-placement="bottom" onclick="document.body.setAttribute('data-bs-theme', 'dark')">
                                <i class="ti ti-moon"></i>
                            </a>
                            <a href="#" class="nav-link px-0 hide-theme-light" title="Enable light mode" data-bs-toggle="tooltip" data-bs-placement="bottom" onclick="document.body.setAttribute('data-bs-theme', 'light')">
                                <i class="ti ti-sun"></i>
                            </a>
                        </div>
                    </div>
                    
                    <!-- Notifications -->
                    <div class="nav-item dropdown d-none d-md-flex me-3">
                        <a href="#" class="nav-link px-0" data-bs-toggle="dropdown" tabindex="-1" aria-label="Show notifications">
                            <i class="ti ti-bell"></i>
                            <span class="badge bg-red"></span>
                        </a>
                        <div class="dropdown-menu dropdown-menu-arrow dropdown-menu-end dropdown-menu-card">
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title">Notifications</h3>
                                </div>
                                <div class="list-group list-group-flush list-group-hoverable">
                                    <div class="list-group-item">
                                        <div class="row align-items-center">
                                            <div class="col-auto">
                                                <span class="status-dot status-dot-animated bg-red d-block"></span>
                                            </div>
                                            <div class="col text-truncate">
                                                <a href="#" class="text-body d-block">Nouveau message</a>
                                                <div class="d-block text-secondary text-truncate mt-n1">
                                                    Marie D. vous a envoyé un message
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- User Menu -->
                    <div class="nav-item dropdown">
                        <a href="#" class="nav-link d-flex lh-1 text-reset p-0" data-bs-toggle="dropdown" aria-label="Open user menu">
                            <span class="avatar avatar-sm" id="user-avatar"></span>
                            <div class="d-none d-xl-block ps-2">
                                <div id="user-name">Utilisateur</div>
                                <div class="mt-1 small text-secondary">Prestataire</div>
                            </div>
                        </a>
                        <div class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                            <a href="profile.html" class="dropdown-item">Mon profil</a>
                            <a href="#" class="dropdown-item">Paramètres</a>
                            <div class="dropdown-divider"></div>
                            <a href="/logout.html" class="dropdown-item">Déconnexion</a>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Sidebar -->
        <aside class="navbar navbar-vertical navbar-expand-lg navbar-transparent">
            <div class="container-fluid">
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#sidebar-menu">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <h1 class="navbar-brand navbar-brand-autodark">
                    <a href="/prestataire/dashboard.html">
                        <img src="../assets/img/logo.svg" width="110" height="32" alt="Portal" class="navbar-brand-image">
                    </a>
                </h1>
                <div class="navbar-nav flex-row d-lg-none">
                    <div class="nav-item d-none d-md-flex me-3">
                        <div class="btn-list-item">
                            <a href="#" class="nav-link px-0" data-bs-toggle="dropdown" tabindex="-1" aria-label="Show notifications">
                                <i class="ti ti-bell"></i>
                                <span class="badge bg-red"></span>
                            </a>
                        </div>
                    </div>
                    <div class="nav-item dropdown">
                        <a href="#" class="nav-link d-flex lh-1 text-reset p-0" data-bs-toggle="dropdown" aria-label="Open user menu">
                            <span class="avatar avatar-sm" id="user-avatar-mobile"></span>
                        </a>
                    </div>
                </div>
                <div class="collapse navbar-collapse" id="sidebar-menu">
                    <ul class="navbar-nav pt-lg-3">
                        <li class="nav-item">
                            <a class="nav-link" href="dashboard.html">
                                <span class="nav-link-icon d-md-none d-lg-inline-block">
                                    <i class="ti ti-home"></i>
                                </span>
                                <span class="nav-link-title">Dashboard</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="missions.html">
                                <span class="nav-link-icon d-md-none d-lg-inline-block">
                                    <i class="ti ti-briefcase"></i>
                                </span>
                                <span class="nav-link-title">Missions</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="calendar.html">
                                <span class="nav-link-icon d-md-none d-lg-inline-block">
                                    <i class="ti ti-calendar"></i>
                                </span>
                                <span class="nav-link-title">Calendrier</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="performance.html">
                                <span class="nav-link-icon d-md-none d-lg-inline-block">
                                    <i class="ti ti-chart-line"></i>
                                </span>
                                <span class="nav-link-title">Performance</span>
                            </a>
                        </li>
                        <li class="nav-item active">
                            <a class="nav-link" href="messages.html">
                                <span class="nav-link-icon d-md-none d-lg-inline-block">
                                    <i class="ti ti-message-circle"></i>
                                </span>
                                <span class="nav-link-title">Messages</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="rewards.html">
                                <span class="nav-link-icon d-md-none d-lg-inline-block">
                                    <i class="ti ti-trophy"></i>
                                </span>
                                <span class="nav-link-title">Récompenses</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </aside>

        <!-- Page Wrapper -->
        <div class="page-wrapper">
            <div class="page-header d-print-none">
                <div class="container-xl">
                    <div class="row g-2 align-items-center">
                        <div class="col">
                            <div class="page-pretitle">Communication</div>
                            <h2 class="page-title">
                                <i class="ti ti-message-circle me-2"></i>
                                Messages & Conversations
                            </h2>
                        </div>
                        <div class="col-auto ms-auto d-print-none">
                            <div class="btn-list">
                                <a href="#" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modal-new-conversation">
                                    <i class="ti ti-plus"></i>
                                    Nouvelle conversation
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="page-body">
                <div class="container-xl">
                    <div class="row g-0">
                        <!-- Liste des conversations -->
                        <div class="col-lg-4 border-end">
                            <div class="chat-sidebar">
                                <!-- Recherche -->
                                <div class="p-3 border-bottom">
                                    <div class="input-icon">
                                        <span class="input-icon-addon">
                                            <i class="ti ti-search"></i>
                                        </span>
                                        <input type="text" class="form-control" placeholder="Rechercher une conversation..." id="searchConversations">
                                    </div>
                                </div>
                                
                                <!-- Tabs -->
                                <div class="nav nav-tabs px-3" role="tablist">
                                    <a class="nav-link active" data-bs-toggle="tab" href="#tab-all" role="tab">
                                        Tous <span class="badge bg-secondary badge-pill ms-1">12</span>
                                    </a>
                                    <a class="nav-link" data-bs-toggle="tab" href="#tab-projects" role="tab">
                                        Projets <span class="badge bg-secondary badge-pill ms-1">8</span>
                                    </a>
                                    <a class="nav-link" data-bs-toggle="tab" href="#tab-support" role="tab">
                                        Support <span class="badge bg-secondary badge-pill ms-1">3</span>
                                    </a>
                                    <a class="nav-link" data-bs-toggle="tab" href="#tab-archives" role="tab">
                                        Archives <span class="badge bg-secondary badge-pill ms-1">1</span>
                                    </a>
                                </div>
                                
                                <!-- Liste conversations -->
                                <div class="tab-content chat-list">
                                    <div class="tab-pane active show" id="tab-all">
                                        <!-- Conversation 1 - Active -->
                                        <div class="chat-item active p-3 border-bottom" onclick="loadConversation(1)">
                                            <div class="row align-items-center">
                                                <div class="col-auto">
                                                    <span class="avatar" style="background-image: url(https://ui-avatars.com/api/?name=Marie+Dubois)">
                                                        <span class="avatar-status bg-success"></span>
                                                    </span>
                                                </div>
                                                <div class="col">
                                                    <div class="d-flex justify-content-between align-items-center">
                                                        <div>
                                                            <div class="fw-medium">Marie D. - Projet API</div>
                                                            <div class="text-secondary text-truncate">J'ai validé les endpoints, tu peux...</div>
                                                        </div>
                                                        <div class="text-end">
                                                            <div class="text-secondary small message-time">14:32</div>
                                                            <span class="badge bg-red badge-pill">2</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Conversation 2 -->
                                        <div class="chat-item p-3 border-bottom" onclick="loadConversation(2)">
                                            <div class="row align-items-center">
                                                <div class="col-auto">
                                                    <span class="avatar bg-blue-lt">
                                                        <i class="ti ti-headset"></i>
                                                    </span>
                                                </div>
                                                <div class="col">
                                                    <div class="d-flex justify-content-between align-items-center">
                                                        <div>
                                                            <div class="fw-medium">Support Technique</div>
                                                            <div class="text-secondary text-truncate">Votre ticket #1234 a été résolu</div>
                                                        </div>
                                                        <div class="text-end">
                                                            <div class="text-secondary small">Il y a 2h</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Conversation 3 -->
                                        <div class="chat-item p-3 border-bottom" onclick="loadConversation(3)">
                                            <div class="row align-items-center">
                                                <div class="col-auto">
                                                    <div class="avatar-list avatar-list-stacked">
                                                        <span class="avatar avatar-sm" style="background-image: url(https://ui-avatars.com/api/?name=Jean+Martin)"></span>
                                                        <span class="avatar avatar-sm" style="background-image: url(https://ui-avatars.com/api/?name=Sophie+Laurent)"></span>
                                                        <span class="avatar avatar-sm">+2</span>
                                                    </div>
                                                </div>
                                                <div class="col">
                                                    <div class="d-flex justify-content-between align-items-center">
                                                        <div>
                                                            <div class="fw-medium">Équipe Mobile App</div>
                                                            <div class="text-secondary text-truncate">Meeting demain à 14h pour...</div>
                                                        </div>
                                                        <div class="text-end">
                                                            <div class="text-secondary small">Hier</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Conversation 4 -->
                                        <div class="chat-item p-3 border-bottom" onclick="loadConversation(4)">
                                            <div class="row align-items-center">
                                                <div class="col-auto">
                                                    <span class="avatar" style="background-image: url(https://ui-avatars.com/api/?name=Pierre+Leroy)">
                                                        <span class="avatar-status bg-success"></span>
                                                    </span>
                                                </div>
                                                <div class="col">
                                                    <div class="d-flex justify-content-between align-items-center">
                                                        <div>
                                                            <div class="fw-medium">Pierre L. - Design System</div>
                                                            <div class="text-secondary text-truncate">Les nouvelles maquettes sont prêtes</div>
                                                        </div>
                                                        <div class="text-end">
                                                            <div class="text-secondary small">Il y a 3h</div>
                                                            <span class="badge bg-red badge-pill">1</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Plus de conversations... -->
                                        <div class="chat-item p-3 border-bottom" onclick="loadConversation(5)">
                                            <div class="row align-items-center">
                                                <div class="col-auto">
                                                    <span class="avatar" style="background-image: url(https://ui-avatars.com/api/?name=Anna+Weber)"></span>
                                                </div>
                                                <div class="col">
                                                    <div class="d-flex justify-content-between align-items-center">
                                                        <div>
                                                            <div class="fw-medium">Anna W. - Migration Cloud</div>
                                                            <div class="text-secondary text-truncate">Merci pour le rapport détaillé</div>
                                                        </div>
                                                        <div class="text-end">
                                                            <div class="text-secondary small">2 jours</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="tab-pane" id="tab-projects">
                                        <!-- Conversations projets -->
                                    </div>
                                    
                                    <div class="tab-pane" id="tab-support">
                                        <!-- Conversations support -->
                                    </div>
                                    
                                    <div class="tab-pane" id="tab-archives">
                                        <!-- Conversations archivées -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Chat actif -->
                        <div class="col-lg-8">
                            <div class="chat-container d-flex flex-column h-100">
                                <!-- Header chat -->
                                <div class="chat-header border-bottom p-3">
                                    <div class="row align-items-center">
                                        <div class="col">
                                            <div class="d-flex align-items-center">
                                                <span class="avatar me-3" style="background-image: url(https://ui-avatars.com/api/?name=Marie+Dubois)">
                                                    <span class="avatar-status bg-success"></span>
                                                </span>
                                                <div>
                                                    <div class="fw-medium">Marie Dubois</div>
                                                    <div class="text-secondary small">Projet API REST - En cours</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-auto">
                                            <div class="btn-list">
                                                <button class="btn btn-ghost-secondary btn-icon" title="Appel vidéo">
                                                    <i class="ti ti-video"></i>
                                                </button>
                                                <button class="btn btn-ghost-secondary btn-icon" title="Informations">
                                                    <i class="ti ti-info-circle"></i>
                                                </button>
                                                <div class="dropdown">
                                                    <button class="btn btn-ghost-secondary btn-icon" data-bs-toggle="dropdown">
                                                        <i class="ti ti-dots-vertical"></i>
                                                    </button>
                                                    <ul class="dropdown-menu dropdown-menu-end">
                                                        <li><a class="dropdown-item" href="#">
                                                            <i class="ti ti-archive me-2"></i>Archiver
                                                        </a></li>
                                                        <li><a class="dropdown-item" href="#">
                                                            <i class="ti ti-mail me-2"></i>Marquer non lu
                                                        </a></li>
                                                        <li><hr class="dropdown-divider"></li>
                                                        <li><a class="dropdown-item text-danger" href="#">
                                                            <i class="ti ti-ban me-2"></i>Bloquer
                                                        </a></li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Zone messages -->
                                <div class="chat-messages flex-grow-1 p-3" id="chatMessages">
                                    <!-- Groupe de messages par jour -->
                                    <div class="chat-date-divider text-center my-3">
                                        <span class="badge bg-secondary-lt">Aujourd'hui</span>
                                    </div>
                                    
                                    <!-- Message reçu -->
                                    <div class="chat-message mb-3">
                                        <div class="d-flex">
                                            <span class="avatar avatar-sm me-2" style="background-image: url(https://ui-avatars.com/api/?name=Marie+Dubois)"></span>
                                            <div class="chat-bubble">
                                                <div class="chat-bubble-content">
                                                    Salut ! J'ai revu ton code pour les endpoints API.
                                                </div>
                                                <div class="chat-bubble-meta">
                                                    <span class="text-secondary small message-time">14:32</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Message envoyé -->
                                    <div class="chat-message mb-3">
                                        <div class="d-flex justify-content-end">
                                            <div class="chat-bubble me">
                                                <div class="chat-bubble-content">
                                                    Super ! Qu'est-ce que tu en penses ?
                                                </div>
                                                <div class="chat-bubble-meta text-end">
                                                    <span class="text-white-50 small message-time">14:35</span>
                                                    <i class="ti ti-checks text-white-50 ms-1"></i>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Message avec fichier -->
                                    <div class="chat-message mb-3">
                                        <div class="d-flex">
                                            <span class="avatar avatar-sm me-2" style="background-image: url(https://ui-avatars.com/api/?name=Marie+Dubois)"></span>
                                            <div class="chat-bubble">
                                                <div class="chat-bubble-content">
                                                    J'ai validé les endpoints, tu peux continuer l'implémentation. Voici mes notes :
                                                </div>
                                                <div class="chat-attachment mt-2">
                                                    <div class="card">
                                                        <div class="card-stamp">
                                                            <div class="card-stamp-icon bg-green">
                                                                <i class="ti ti-file-text"></i>
                                                            </div>
                                                        </div>
                                                        <div class="card-body p-2">
                                                            <div class="row align-items-center">
                                                                <div class="col-auto">
                                                                    <span class="avatar avatar-sm bg-blue-lt">
                                                                        <i class="ti ti-file-text"></i>
                                                                    </span>
                                                                </div>
                                                                <div class="col">
                                                                    <div class="fw-medium">review-api.pdf</div>
                                                                    <div class="text-secondary small file-size">245 KB</div>
                                                                </div>
                                                                <div class="col-auto">
                                                                    <a href="#" class="btn btn-sm btn-ghost-secondary">
                                                                        <i class="ti ti-download"></i>
                                                                    </a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="chat-bubble-meta">
                                                    <span class="text-secondary small message-time">14:38</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Plus de messages... -->
                                    <div class="chat-message mb-3">
                                        <div class="d-flex justify-content-end">
                                            <div class="chat-bubble me">
                                                <div class="chat-bubble-content">
                                                    Parfait, je regarde ça tout de suite ! Je pense pouvoir terminer d'ici demain.
                                                </div>
                                                <div class="chat-bubble-meta text-end">
                                                    <span class="text-white-50 small message-time">14:40</span>
                                                    <i class="ti ti-check text-white-50 ms-1"></i>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Indicateur de frappe -->
                                    <div class="typing-indicator" id="typingIndicator">
                                        <span class="avatar avatar-sm me-2" style="background-image: url(https://ui-avatars.com/api/?name=Marie+Dubois)"></span>
                                        <span class="text-secondary small">Marie est en train d'écrire...</span>
                                    </div>
                                </div>
                                
                                <!-- Zone de saisie -->
                                <div class="chat-input border-top p-3">
                                    <form id="chatForm" onsubmit="sendMessage(event)">
                                        <div class="row g-2 align-items-end">
                                            <div class="col">
                                                <textarea class="form-control" id="messageInput" rows="1" placeholder="Écrivez votre message..." onkeypress="handleKeyPress(event)"></textarea>
                                            </div>
                                            <div class="col-auto">
                                                <div class="btn-list">
                                                    <button type="button" class="btn btn-ghost-secondary btn-icon" title="Emoji">
                                                        <i class="ti ti-mood-smile"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-ghost-secondary btn-icon" onclick="document.getElementById('fileInput').click()" title="Joindre fichier">
                                                        <i class="ti ti-paperclip"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-ghost-secondary btn-icon" title="Code snippet">
                                                        <i class="ti ti-code"></i>
                                                    </button>
                                                    <button type="submit" class="btn btn-primary btn-icon" title="Envoyer">
                                                        <i class="ti ti-send"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                    <input type="file" id="fileInput" class="d-none" onchange="handleFileSelect(event)">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <footer class="footer footer-transparent d-print-none">
                <div class="container-xl">
                    <div class="row text-center align-items-center flex-row-reverse">
                        <div class="col-lg-auto ms-lg-auto">
                            <ul class="list-inline list-inline-dots mb-0">
                                <li class="list-inline-item"><a href="#" class="link-secondary">Documentation</a></li>
                                <li class="list-inline-item"><a href="#" class="link-secondary">Support</a></li>
                            </ul>
                        </div>
                        <div class="col-12 col-lg-auto mt-3 mt-lg-0">
                            <ul class="list-inline list-inline-dots mb-0">
                                <li class="list-inline-item">
                                    Copyright &copy; 2025
                                    <a href="." class="link-secondary">Portal Pro</a>.
                                    Tous droits réservés.
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </footer>
        </div>
    </div>

    <!-- Modal nouvelle conversation -->
    <div class="modal modal-blur fade" id="modal-new-conversation" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Nouvelle conversation</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">Destinataire(s)</label>
                        <select class="form-select" multiple>
                            <option value="1">Marie Dubois - Client API</option>
                            <option value="2">Jean Martin - Client E-commerce</option>
                            <option value="3">Support Technique</option>
                            <option value="4">Pierre Leroy - Designer</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Sujet</label>
                        <input type="text" class="form-control" placeholder="Ex: Question sur le projet...">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Message</label>
                        <textarea class="form-control" rows="3" placeholder="Écrivez votre message..."></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn me-auto" data-bs-dismiss="modal">Annuler</button>
                    <button type="button" class="btn btn-primary">
                        <i class="ti ti-send"></i>
                        Démarrer conversation
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- JS Tabler -->
    <script src="https://cdn.jsdelivr.net/npm/@tabler/core@latest/dist/js/tabler.min.js"></script>
    
    <!-- Custom JS -->
    <script src="../assets/js/app.js"></script>
    <script src="../assets/js/auth.js"></script>
    
    <script>
        // Gestion envoi message
        function sendMessage(event) {
            event.preventDefault();
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (message) {
                console.log('Message envoyé:', message);
                input.value = '';
                input.style.height = 'auto';
            }
        }
        
        // Gestion Enter pour envoyer
        function handleKeyPress(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage(event);
            }
        }
        
        // Charger une conversation
        function loadConversation(id) {
            console.log('Chargement conversation', id);
            // Retirer active de toutes les conversations
            document.querySelectorAll('.chat-item').forEach(item => {
                item.classList.remove('active');
            });
            // Ajouter active à la conversation sélectionnée
            event.currentTarget.classList.add('active');
        }
        
        // Gestion sélection fichier
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                console.log('Fichier sélectionné:', file.name);
            }
        }
        
        // Auto-resize textarea
        document.addEventListener('DOMContentLoaded', function() {
            const messageInput = document.getElementById('messageInput');
            if (messageInput) {
                messageInput.addEventListener('input', function() {
                    this.style.height = 'auto';
                    this.style.height = (this.scrollHeight) + 'px';
                });
            }
            
            // Initialize user data
            const userData = JSON.parse(localStorage.getItem('currentUser') || '{}');
            if (userData.name) {
                document.getElementById('user-name').textContent = userData.name;
                document.getElementById('user-avatar').style.backgroundImage = `url(${userData.avatar})`;
                document.getElementById('user-avatar-mobile').style.backgroundImage = `url(${userData.avatar})`;
            }
        });
    </script>
</body>
</html>