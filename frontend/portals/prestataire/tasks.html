<!doctype html>
<html lang="fr">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
    <meta http-equiv="X-UA-Compatible" content="ie=edge"/>
    <title>Vue Kanban - Espace Prestataire</title>
    
    <!-- CSS Tabler -->
    <link href="https://cdn.jsdelivr.net/npm/@tabler/core@latest/dist/css/tabler.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@tabler/core@latest/dist/css/tabler-flags.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@tabler/core@latest/dist/css/tabler-payments.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@tabler/core@latest/dist/css/tabler-vendors.min.css" rel="stylesheet">
    
    <!-- Tabler Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tabler/icons@latest/iconfont/tabler-icons.min.css">
    
    <!-- SortableJS for drag & drop -->
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
    
    <!-- Custom CSS -->
    <link href="../assets/css/custom.css" rel="stylesheet">
    
    <style>
        [data-bs-theme="dark"] .hide-theme-dark { display: none !important; }
        [data-bs-theme="light"] .hide-theme-light { display: none !important; }
        
        /* JetBrains Mono pour les valeurs numériques */
        .timer,
        .timer-display,
        .task-effort,
        .effort-hours,
        .count-badge,
        #timerDisplay {
            font-family: 'JetBrains Mono', monospace !important;
            font-weight: 600;
        }
        
        .kanban-board {
            overflow-x: auto;
            padding-bottom: 1rem;
        }
        
        .kanban-column {
            background: var(--tblr-bg-surface);
            border-radius: 0.5rem;
            padding: 1rem;
            min-height: 600px;
            border: 1px solid var(--tblr-border-color);
        }
        
        .kanban-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid var(--tblr-border-color);
        }
        
        .kanban-title {
            font-size: 1rem;
            font-weight: 600;
            margin: 0;
            display: flex;
            align-items: center;
        }
        
        .kanban-items {
            min-height: 500px;
        }
        
        .kanban-item {
            margin-bottom: 0.75rem;
            cursor: move;
            transition: all 0.2s;
        }
        
        .kanban-item.sortable-ghost {
            opacity: 0.5;
        }
        
        .kanban-item.sortable-drag {
            opacity: 0;
        }
        
        .task-card {
            background: var(--tblr-bg-surface-secondary);
            border-radius: 0.5rem;
            padding: 1rem;
            border: 1px solid var(--tblr-border-color);
            transition: all 0.2s;
        }
        
        .task-card:hover {
            border-color: var(--tblr-green);
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .task-card.task-completed {
            opacity: 0.7;
        }
        
        .task-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
        }
        
        .task-priority {
            width: 4px;
            height: 20px;
            border-radius: 2px;
        }
        
        .priority-high {
            background: var(--tblr-red);
        }
        
        .priority-medium {
            background: var(--tblr-yellow);
        }
        
        .priority-low {
            background: var(--tblr-green);
        }
        
        .task-mission {
            font-size: 0.75rem;
            color: var(--tblr-secondary);
            flex: 1;
        }
        
        .task-title {
            font-size: 0.9375rem;
            font-weight: 600;
            margin: 0 0 0.5rem 0;
        }
        
        .task-description {
            font-size: 0.875rem;
            color: var(--tblr-secondary);
            margin-bottom: 0.75rem;
        }
        
        .task-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 0.25rem;
            margin-bottom: 0.75rem;
        }
        
        .skill-tag {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            background: var(--tblr-green-lt);
            color: var(--tblr-green);
            border-radius: 0.25rem;
            font-size: 0.75rem;
            font-weight: 500;
            border: 1px solid var(--tblr-green);
        }
        
        .skill-tag-sm {
            padding: 0.125rem 0.375rem;
            font-size: 0.625rem;
        }
        
        .task-footer {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 0.75rem;
            font-size: 0.75rem;
            color: var(--tblr-secondary);
        }
        
        .task-actions {
            margin-top: 0.5rem;
        }
        
        .timer-widget {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: var(--tblr-bg-surface);
            border: 1px solid var(--tblr-border-color);
            border-radius: 0.5rem;
        }
        
        .timer-display {
            font-size: 1.125rem;
            color: var(--tblr-green);
        }
        
        .timer-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.25rem 0.5rem;
            background: var(--tblr-green-lt);
            color: var(--tblr-green);
            border-radius: 0.25rem;
            font-size: 0.75rem;
            margin-left: auto;
        }
        
        .review-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.25rem 0.5rem;
            background: var(--tblr-orange-lt);
            color: var(--tblr-orange);
            border-radius: 0.25rem;
            font-size: 0.75rem;
            margin-left: auto;
        }
        
        .completed-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.25rem 0.5rem;
            background: var(--tblr-green-lt);
            color: var(--tblr-green);
            border-radius: 0.25rem;
            font-size: 0.75rem;
            margin-left: auto;
        }
        
        .kanban-item.active-timer .task-card {
            border-color: var(--tblr-green);
            background: var(--tblr-green-lt);
        }
        
        .task-reviewer {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }
    </style>
</head>
<body data-bs-theme="light" class="layout-fluid role-prestataire">
    <div class="page">
        <!-- Navbar -->
        <header class="navbar navbar-expand-md navbar-light d-none d-lg-flex d-print-none">
            <div class="container-xl">
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar-menu">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="navbar-nav flex-row order-md-last">
                    <!-- Dark Mode Toggle -->
                    <div class="nav-item d-none d-md-flex me-3">
                        <div class="btn-list-item">
                            <a href="#" class="nav-link px-0 hide-theme-dark" title="Enable dark mode" data-bs-toggle="tooltip" data-bs-placement="bottom" onclick="document.body.setAttribute('data-bs-theme', 'dark')">
                                <i class="ti ti-moon"></i>
                            </a>
                            <a href="#" class="nav-link px-0 hide-theme-light" title="Enable light mode" data-bs-toggle="tooltip" data-bs-placement="bottom" onclick="document.body.setAttribute('data-bs-theme', 'light')">
                                <i class="ti ti-sun"></i>
                            </a>
                        </div>
                    </div>
                    
                    <!-- Notifications -->
                    <div class="nav-item dropdown d-none d-md-flex me-3">
                        <a href="#" class="nav-link px-0" data-bs-toggle="dropdown" tabindex="-1" aria-label="Show notifications">
                            <i class="ti ti-bell"></i>
                            <span class="badge bg-red"></span>
                        </a>
                        <div class="dropdown-menu dropdown-menu-arrow dropdown-menu-end dropdown-menu-card">
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title">Notifications</h3>
                                </div>
                                <div class="list-group list-group-flush list-group-hoverable">
                                    <div class="list-group-item">
                                        <div class="row align-items-center">
                                            <div class="col-auto">
                                                <span class="status-dot status-dot-animated bg-red d-block"></span>
                                            </div>
                                            <div class="col text-truncate">
                                                <a href="#" class="text-body d-block">Nouvelle tâche</a>
                                                <div class="d-block text-secondary text-truncate mt-n1">
                                                    Endpoints produits ajoutée
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- User Menu -->
                    <div class="nav-item dropdown">
                        <a href="#" class="nav-link d-flex lh-1 text-reset p-0" data-bs-toggle="dropdown" aria-label="Open user menu">
                            <span class="avatar avatar-sm" id="user-avatar"></span>
                            <div class="d-none d-xl-block ps-2">
                                <div id="user-name">Utilisateur</div>
                                <div class="mt-1 small text-secondary">Prestataire</div>
                            </div>
                        </a>
                        <div class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                            <a href="profile.html" class="dropdown-item">Mon profil</a>
                            <a href="#" class="dropdown-item">Paramètres</a>
                            <div class="dropdown-divider"></div>
                            <a href="/logout.html" class="dropdown-item">Déconnexion</a>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Sidebar -->
        <aside class="navbar navbar-vertical navbar-expand-lg navbar-transparent">
            <div class="container-fluid">
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#sidebar-menu">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <h1 class="navbar-brand navbar-brand-autodark">
                    <a href="/prestataire/dashboard.html">
                        <img src="../assets/img/logo.svg" width="110" height="32" alt="Portal" class="navbar-brand-image">
                    </a>
                </h1>
                <div class="navbar-nav flex-row d-lg-none">
                    <div class="nav-item d-none d-md-flex me-3">
                        <div class="btn-list-item">
                            <a href="#" class="nav-link px-0" data-bs-toggle="dropdown" tabindex="-1" aria-label="Show notifications">
                                <i class="ti ti-bell"></i>
                                <span class="badge bg-red"></span>
                            </a>
                        </div>
                    </div>
                    <div class="nav-item dropdown">
                        <a href="#" class="nav-link d-flex lh-1 text-reset p-0" data-bs-toggle="dropdown" aria-label="Open user menu">
                            <span class="avatar avatar-sm" id="user-avatar-mobile"></span>
                        </a>
                    </div>
                </div>
                <div class="collapse navbar-collapse" id="sidebar-menu">
                    <ul class="navbar-nav pt-lg-3">
                        <li class="nav-item">
                            <a class="nav-link" href="dashboard.html">
                                <span class="nav-link-icon d-md-none d-lg-inline-block">
                                    <i class="ti ti-home"></i>
                                </span>
                                <span class="nav-link-title">Dashboard</span>
                            </a>
                        </li>
                        <li class="nav-item active">
                            <a class="nav-link" href="missions.html">
                                <span class="nav-link-icon d-md-none d-lg-inline-block">
                                    <i class="ti ti-briefcase"></i>
                                </span>
                                <span class="nav-link-title">Missions</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="calendar.html">
                                <span class="nav-link-icon d-md-none d-lg-inline-block">
                                    <i class="ti ti-calendar"></i>
                                </span>
                                <span class="nav-link-title">Calendrier</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="performance.html">
                                <span class="nav-link-icon d-md-none d-lg-inline-block">
                                    <i class="ti ti-chart-line"></i>
                                </span>
                                <span class="nav-link-title">Performance</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="messages.html">
                                <span class="nav-link-icon d-md-none d-lg-inline-block">
                                    <i class="ti ti-message-circle"></i>
                                </span>
                                <span class="nav-link-title">Messages</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="rewards.html">
                                <span class="nav-link-icon d-md-none d-lg-inline-block">
                                    <i class="ti ti-trophy"></i>
                                </span>
                                <span class="nav-link-title">Récompenses</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </aside>

        <!-- Page Wrapper -->
        <div class="page-wrapper">
            <div class="page-header d-print-none">
                <div class="container-xl">
                    <div class="row g-2 align-items-center">
                        <div class="col">
                            <div class="page-pretitle">Gestion des tâches</div>
                            <h2 class="page-title">
                                <i class="ti ti-layout-kanban me-2"></i>
                                Vue Kanban - Toutes les tâches
                            </h2>
                        </div>
                        <div class="col-auto ms-auto d-print-none">
                            <div class="btn-list">
                                <!-- Timer actif -->
                                <div class="timer-widget" id="activeTimer" style="display: none;">
                                    <div class="timer-display">
                                        <i class="ti ti-clock text-success"></i>
                                        <span id="timerDisplay">00:00:00</span>
                                        <button class="btn btn-sm btn-success" onclick="stopTimer()">
                                            <i class="ti ti-square-filled"></i>
                                        </button>
                                    </div>
                                </div>
                                
                                <!-- Filtres -->
                                <div class="dropdown">
                                    <button class="btn btn-ghost-secondary dropdown-toggle" data-bs-toggle="dropdown">
                                        <i class="ti ti-filter"></i>
                                        Mission: Toutes
                                    </button>
                                    <ul class="dropdown-menu">
                                        <li><a class="dropdown-item" href="#" onclick="filterByMission('all')">Toutes</a></li>
                                        <li><a class="dropdown-item" href="#" onclick="filterByMission('1')">API REST</a></li>
                                        <li><a class="dropdown-item" href="#" onclick="filterByMission('2')">E-commerce</a></li>
                                        <li><a class="dropdown-item" href="#" onclick="filterByMission('3')">Design System</a></li>
                                        <li><a class="dropdown-item" href="#" onclick="filterByMission('4')">Migration AWS</a></li>
                                    </ul>
                                </div>
                                
                                <div class="dropdown">
                                    <button class="btn btn-ghost-secondary dropdown-toggle" data-bs-toggle="dropdown">
                                        <i class="ti ti-flag"></i>
                                        Priorité
                                    </button>
                                    <ul class="dropdown-menu">
                                        <li><a class="dropdown-item" href="#" onclick="filterByPriority('all')">Toutes</a></li>
                                        <li><a class="dropdown-item" href="#" onclick="filterByPriority('high')">Haute</a></li>
                                        <li><a class="dropdown-item" href="#" onclick="filterByPriority('medium')">Moyenne</a></li>
                                        <li><a class="dropdown-item" href="#" onclick="filterByPriority('low')">Basse</a></li>
                                    </ul>
                                </div>
                                
                                <button class="btn btn-primary" onclick="addNewTask()">
                                    <i class="ti ti-plus"></i>
                                    Nouvelle tâche
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="page-body">
                <div class="container-xl">
                    <!-- Raccourcis clavier info -->
                    <div class="alert alert-info alert-dismissible">
                        <div class="d-flex">
                            <div>
                                <i class="ti ti-keyboard alert-icon"></i>
                            </div>
                            <div>
                                <strong>Raccourcis clavier:</strong>
                                <kbd>T</kbd> = Démarrer/arrêter timer • 
                                <kbd>N</kbd> = Nouvelle tâche • 
                                <kbd>Esc</kbd> = Fermer modals
                            </div>
                        </div>
                        <a class="btn-close" data-bs-dismiss="alert" aria-label="close"></a>
                    </div>

                    <!-- Vue Kanban -->
                    <div class="kanban-board">
                        <div class="row">
                            <!-- Colonne À faire -->
                            <div class="col-lg-3">
                                <div class="kanban-column" data-status="todo">
                                    <div class="kanban-header">
                                        <h3 class="kanban-title">
                                            <i class="ti ti-list me-2"></i>
                                            À faire
                                            <span class="badge bg-secondary ms-2 count-badge" id="count-todo">8</span>
                                        </h3>
                                    </div>
                                    <div class="kanban-items" id="kanban-todo">
                                        <!-- Tâche 1 -->
                                        <div class="kanban-item" data-task-id="1" data-mission="1" data-priority="high">
                                            <div class="task-card">
                                                <div class="card-stamp">
                                                    <div class="card-stamp-icon bg-green">
                                                        <i class="ti ti-list-check"></i>
                                                    </div>
                                                </div>
                                                <div class="task-header">
                                                    <div class="task-priority priority-high"></div>
                                                    <div class="task-mission">API REST</div>
                                                    <div class="dropdown ms-auto">
                                                        <button class="btn btn-sm btn-ghost-secondary dropdown-toggle" data-bs-toggle="dropdown">
                                                            <i class="ti ti-dots"></i>
                                                        </button>
                                                        <ul class="dropdown-menu">
                                                            <li><a class="dropdown-item" href="#" onclick="editTask(1)">
                                                                <i class="ti ti-edit me-2"></i>Modifier
                                                            </a></li>
                                                            <li><a class="dropdown-item" href="#" onclick="deleteTask(1)">
                                                                <i class="ti ti-trash me-2"></i>Supprimer
                                                            </a></li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="task-content">
                                                    <h4 class="task-title">Endpoints produits</h4>
                                                    <div class="task-description">
                                                        Implémenter CRUD pour les produits avec validation
                                                    </div>
                                                    <div class="task-meta">
                                                        <span class="skill-tag skill-tag-sm">Node.js</span>
                                                        <span class="skill-tag skill-tag-sm">PostgreSQL</span>
                                                    </div>
                                                    <div class="task-footer">
                                                        <div class="task-effort">
                                                            <i class="ti ti-clock"></i>
                                                            <span class="effort-hours">6h</span> estimées
                                                        </div>
                                                        <div class="task-deadline">
                                                            <i class="ti ti-calendar text-danger"></i>
                                                            24 Jan
                                                        </div>
                                                    </div>
                                                    <div class="task-actions">
                                                        <button class="btn btn-sm btn-success w-100" onclick="startTaskTimer(1)">
                                                            <i class="ti ti-play"></i>
                                                            Démarrer timer
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Tâche 2 -->
                                        <div class="kanban-item" data-task-id="2" data-mission="2" data-priority="medium">
                                            <div class="task-card">
                                                <div class="card-stamp">
                                                    <div class="card-stamp-icon bg-green">
                                                        <i class="ti ti-list-check"></i>
                                                    </div>
                                                </div>
                                                <div class="task-header">
                                                    <div class="task-priority priority-medium"></div>
                                                    <div class="task-mission">E-commerce</div>
                                                    <div class="dropdown ms-auto">
                                                        <button class="btn btn-sm btn-ghost-secondary dropdown-toggle" data-bs-toggle="dropdown">
                                                            <i class="ti ti-dots"></i>
                                                        </button>
                                                        <ul class="dropdown-menu">
                                                            <li><a class="dropdown-item" href="#" onclick="editTask(2)">
                                                                <i class="ti ti-edit me-2"></i>Modifier
                                                            </a></li>
                                                            <li><a class="dropdown-item" href="#" onclick="deleteTask(2)">
                                                                <i class="ti ti-trash me-2"></i>Supprimer
                                                            </a></li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="task-content">
                                                    <h4 class="task-title">Panier d'achat</h4>
                                                    <div class="task-description">
                                                        Interface utilisateur pour gestion panier
                                                    </div>
                                                    <div class="task-meta">
                                                        <span class="skill-tag skill-tag-sm">React Native</span>
                                                        <span class="skill-tag skill-tag-sm">Redux</span>
                                                    </div>
                                                    <div class="task-footer">
                                                        <div class="task-effort">
                                                            <i class="ti ti-clock"></i>
                                                            <span class="effort-hours">4h</span> estimées
                                                        </div>
                                                        <div class="task-deadline">
                                                            <i class="ti ti-calendar text-warning"></i>
                                                            28 Jan
                                                        </div>
                                                    </div>
                                                    <div class="task-actions">
                                                        <button class="btn btn-sm btn-success w-100" onclick="startTaskTimer(2)">
                                                            <i class="ti ti-play"></i>
                                                            Démarrer timer
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Tâche 3 -->
                                        <div class="kanban-item" data-task-id="3" data-mission="3" data-priority="low">
                                            <div class="task-card">
                                                <div class="card-stamp">
                                                    <div class="card-stamp-icon bg-green">
                                                        <i class="ti ti-list-check"></i>
                                                    </div>
                                                </div>
                                                <div class="task-header">
                                                    <div class="task-priority priority-low"></div>
                                                    <div class="task-mission">Design System</div>
                                                    <div class="dropdown ms-auto">
                                                        <button class="btn btn-sm btn-ghost-secondary dropdown-toggle" data-bs-toggle="dropdown">
                                                            <i class="ti ti-dots"></i>
                                                        </button>
                                                        <ul class="dropdown-menu">
                                                            <li><a class="dropdown-item" href="#" onclick="editTask(3)">
                                                                <i class="ti ti-edit me-2"></i>Modifier
                                                            </a></li>
                                                            <li><a class="dropdown-item" href="#" onclick="deleteTask(3)">
                                                                <i class="ti ti-trash me-2"></i>Supprimer
                                                            </a></li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="task-content">
                                                    <h4 class="task-title">Composants boutons</h4>
                                                    <div class="task-description">
                                                        Créer variantes boutons pour design system
                                                    </div>
                                                    <div class="task-meta">
                                                        <span class="skill-tag skill-tag-sm">Figma</span>
                                                        <span class="skill-tag skill-tag-sm">CSS</span>
                                                    </div>
                                                    <div class="task-footer">
                                                        <div class="task-effort">
                                                            <i class="ti ti-clock"></i>
                                                            <span class="effort-hours">3h</span> estimées
                                                        </div>
                                                        <div class="task-deadline">
                                                            <i class="ti ti-calendar text-success"></i>
                                                            30 Jan
                                                        </div>
                                                    </div>
                                                    <div class="task-actions">
                                                        <button class="btn btn-sm btn-success w-100" onclick="startTaskTimer(3)">
                                                            <i class="ti ti-play"></i>
                                                            Démarrer timer
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Colonne En cours -->
                            <div class="col-lg-3">
                                <div class="kanban-column" data-status="inprogress">
                                    <div class="kanban-header">
                                        <h3 class="kanban-title">
                                            <i class="ti ti-loader me-2"></i>
                                            En cours
                                            <span class="badge bg-blue ms-2 count-badge" id="count-inprogress">5</span>
                                        </h3>
                                    </div>
                                    <div class="kanban-items" id="kanban-inprogress">
                                        <!-- Tâche en cours avec timer -->
                                        <div class="kanban-item active-timer" data-task-id="4" data-mission="1" data-priority="high">
                                            <div class="task-card">
                                                <div class="card-stamp">
                                                    <div class="card-stamp-icon bg-yellow">
                                                        <i class="ti ti-clock"></i>
                                                    </div>
                                                </div>
                                                <div class="task-header">
                                                    <div class="task-priority priority-high"></div>
                                                    <div class="task-mission">API REST</div>
                                                    <div class="timer-badge">
                                                        <i class="ti ti-clock"></i>
                                                        <span class="timer" id="timer-4">02:15:30</span>
                                                    </div>
                                                </div>
                                                <div class="task-content">
                                                    <h4 class="task-title">Auth JWT</h4>
                                                    <div class="task-description">
                                                        Système d'authentification avec tokens
                                                    </div>
                                                    <div class="task-meta">
                                                        <span class="skill-tag skill-tag-sm">JWT</span>
                                                        <span class="skill-tag skill-tag-sm">Bcrypt</span>
                                                    </div>
                                                    <div class="task-footer">
                                                        <div class="task-effort">
                                                            <i class="ti ti-clock"></i>
                                                            <span class="effort-hours">8h</span> estimées
                                                        </div>
                                                        <div class="task-deadline">
                                                            <i class="ti ti-calendar text-danger"></i>
                                                            23 Jan
                                                        </div>
                                                    </div>
                                                    <div class="task-actions">
                                                        <button class="btn btn-sm btn-danger w-100" onclick="stopTaskTimer(4)">
                                                            <i class="ti ti-square-filled"></i>
                                                            Arrêter timer
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Autres tâches en cours -->
                                        <div class="kanban-item" data-task-id="5" data-mission="2" data-priority="medium">
                                            <div class="task-card">
                                                <div class="card-stamp">
                                                    <div class="card-stamp-icon bg-blue">
                                                        <i class="ti ti-progress"></i>
                                                    </div>
                                                </div>
                                                <div class="task-header">
                                                    <div class="task-priority priority-medium"></div>
                                                    <div class="task-mission">E-commerce</div>
                                                    <div class="dropdown ms-auto">
                                                        <button class="btn btn-sm btn-ghost-secondary dropdown-toggle" data-bs-toggle="dropdown">
                                                            <i class="ti ti-dots"></i>
                                                        </button>
                                                        <ul class="dropdown-menu">
                                                            <li><a class="dropdown-item" href="#" onclick="editTask(5)">
                                                                <i class="ti ti-edit me-2"></i>Modifier
                                                            </a></li>
                                                            <li><a class="dropdown-item" href="#" onclick="deleteTask(5)">
                                                                <i class="ti ti-trash me-2"></i>Supprimer
                                                            </a></li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="task-content">
                                                    <h4 class="task-title">Paiement Stripe</h4>
                                                    <div class="task-description">
                                                        Intégration API Stripe pour paiements
                                                    </div>
                                                    <div class="task-meta">
                                                        <span class="skill-tag skill-tag-sm">Stripe</span>
                                                        <span class="skill-tag skill-tag-sm">Webhooks</span>
                                                    </div>
                                                    <div class="task-footer">
                                                        <div class="task-effort">
                                                            <i class="ti ti-clock"></i>
                                                            <span class="effort-hours">5h</span> estimées
                                                        </div>
                                                        <div class="task-deadline">
                                                            <i class="ti ti-calendar text-warning"></i>
                                                            26 Jan
                                                        </div>
                                                    </div>
                                                    <div class="task-actions">
                                                        <button class="btn btn-sm btn-success w-100" onclick="startTaskTimer(5)">
                                                            <i class="ti ti-play"></i>
                                                            Démarrer timer
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Colonne En review -->
                            <div class="col-lg-3">
                                <div class="kanban-column" data-status="review">
                                    <div class="kanban-header">
                                        <h3 class="kanban-title">
                                            <i class="ti ti-eye me-2"></i>
                                            En review
                                            <span class="badge bg-orange ms-2 count-badge" id="count-review">3</span>
                                        </h3>
                                    </div>
                                    <div class="kanban-items" id="kanban-review">
                                        <!-- Tâche en review -->
                                        <div class="kanban-item" data-task-id="6" data-mission="3" data-priority="high">
                                            <div class="task-card">
                                                <div class="card-stamp">
                                                    <div class="card-stamp-icon bg-orange">
                                                        <i class="ti ti-eye"></i>
                                                    </div>
                                                </div>
                                                <div class="task-header">
                                                    <div class="task-priority priority-high"></div>
                                                    <div class="task-mission">Design System</div>
                                                    <div class="review-badge">
                                                        <i class="ti ti-eye"></i>
                                                        En review
                                                    </div>
                                                </div>
                                                <div class="task-content">
                                                    <h4 class="task-title">Grille layout</h4>
                                                    <div class="task-description">
                                                        Système de grille responsive CSS
                                                    </div>
                                                    <div class="task-meta">
                                                        <span class="skill-tag skill-tag-sm">CSS Grid</span>
                                                        <span class="skill-tag skill-tag-sm">Flexbox</span>
                                                    </div>
                                                    <div class="task-footer">
                                                        <div class="task-effort">
                                                            <i class="ti ti-clock"></i>
                                                            <span class="effort-hours">4h</span> passées
                                                        </div>
                                                        <div class="task-reviewer">
                                                            <span class="avatar avatar-xs" style="background-image: url(https://ui-avatars.com/api/?name=Marie+Dubois)"></span>
                                                            Marie D.
                                                        </div>
                                                    </div>
                                                    <div class="task-actions">
                                                        <button class="btn btn-sm btn-ghost-secondary w-100" onclick="viewReviewComments(6)">
                                                            <i class="ti ti-message"></i>
                                                            Voir commentaires
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Colonne Terminé -->
                            <div class="col-lg-3">
                                <div class="kanban-column" data-status="done">
                                    <div class="kanban-header">
                                        <h3 class="kanban-title">
                                            <i class="ti ti-circle-check me-2"></i>
                                            Terminé
                                            <span class="badge bg-success ms-2 count-badge" id="count-done">42</span>
                                        </h3>
                                    </div>
                                    <div class="kanban-items" id="kanban-done">
                                        <!-- Tâches terminées (montrer seulement les récentes) -->
                                        <div class="kanban-item" data-task-id="7" data-mission="1" data-priority="high">
                                            <div class="task-card task-completed">
                                                <div class="card-stamp">
                                                    <div class="card-stamp-icon bg-green">
                                                        <i class="ti ti-check"></i>
                                                    </div>
                                                </div>
                                                <div class="task-header">
                                                    <div class="task-priority priority-high"></div>
                                                    <div class="task-mission">API REST</div>
                                                    <div class="completed-badge">
                                                        <i class="ti ti-check"></i>
                                                        Terminé
                                                    </div>
                                                </div>
                                                <div class="task-content">
                                                    <h4 class="task-title">Base de données</h4>
                                                    <div class="task-description">
                                                        Setup PostgreSQL et migrations initiales
                                                    </div>
                                                    <div class="task-meta">
                                                        <span class="skill-tag skill-tag-sm">PostgreSQL</span>
                                                        <span class="skill-tag skill-tag-sm">Migrations</span>
                                                    </div>
                                                    <div class="task-footer">
                                                        <div class="task-effort">
                                                            <i class="ti ti-clock text-success"></i>
                                                            <span class="effort-hours">3h</span> réelles
                                                        </div>
                                                        <div class="task-completed-date">
                                                            <i class="ti ti-calendar-check text-success"></i>
                                                            22 Jan
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="kanban-item" data-task-id="8" data-mission="2" data-priority="medium">
                                            <div class="task-card task-completed">
                                                <div class="card-stamp">
                                                    <div class="card-stamp-icon bg-green">
                                                        <i class="ti ti-check"></i>
                                                    </div>
                                                </div>
                                                <div class="task-header">
                                                    <div class="task-priority priority-medium"></div>
                                                    <div class="task-mission">E-commerce</div>
                                                    <div class="completed-badge">
                                                        <i class="ti ti-check"></i>
                                                        Terminé
                                                    </div>
                                                </div>
                                                <div class="task-content">
                                                    <h4 class="task-title">Setup projet</h4>
                                                    <div class="task-description">
                                                        Configuration React Native et dépendances
                                                    </div>
                                                    <div class="task-meta">
                                                        <span class="skill-tag skill-tag-sm">React Native</span>
                                                        <span class="skill-tag skill-tag-sm">Metro</span>
                                                    </div>
                                                    <div class="task-footer">
                                                        <div class="task-effort">
                                                            <i class="ti ti-clock text-success"></i>
                                                            <span class="effort-hours">2h</span> réelles
                                                        </div>
                                                        <div class="task-completed-date">
                                                            <i class="ti ti-calendar-check text-success"></i>
                                                            21 Jan
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Bouton voir plus -->
                                        <div class="text-center py-3">
                                            <button class="btn btn-sm btn-ghost-secondary" onclick="showAllCompletedTasks()">
                                                <i class="ti ti-plus"></i>
                                                Voir toutes (40 autres)
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <footer class="footer footer-transparent d-print-none">
                <div class="container-xl">
                    <div class="row text-center align-items-center flex-row-reverse">
                        <div class="col-lg-auto ms-lg-auto">
                            <ul class="list-inline list-inline-dots mb-0">
                                <li class="list-inline-item"><a href="#" class="link-secondary">Documentation</a></li>
                                <li class="list-inline-item"><a href="#" class="link-secondary">Support</a></li>
                            </ul>
                        </div>
                        <div class="col-12 col-lg-auto mt-3 mt-lg-0">
                            <ul class="list-inline list-inline-dots mb-0">
                                <li class="list-inline-item">
                                    Copyright &copy; 2025
                                    <a href="." class="link-secondary">Portal Pro</a>.
                                    Tous droits réservés.
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </footer>
        </div>
    </div>

    <!-- Modal Nouvelle tâche -->
    <div class="modal modal-blur fade" id="modal-new-task" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Nouvelle tâche</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-lg-8">
                            <div class="mb-3">
                                <label class="form-label required">Titre de la tâche</label>
                                <input type="text" class="form-control" id="taskTitle" placeholder="Ex: Implémenter authentification">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Description</label>
                                <textarea class="form-control" id="taskDescription" rows="3" placeholder="Décrivez la tâche en détail..."></textarea>
                            </div>
                            <div class="row">
                                <div class="col-6">
                                    <div class="mb-3">
                                        <label class="form-label required">Mission</label>
                                        <select class="form-select" id="taskMission">
                                            <option value="1">API REST - TechCorp</option>
                                            <option value="2">E-commerce - StartupFood</option>
                                            <option value="3">Design System - DesignStudio</option>
                                            <option value="4">Migration AWS - MobileBanking</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="mb-3">
                                        <label class="form-label">Priorité</label>
                                        <select class="form-select" id="taskPriority">
                                            <option value="low">Basse</option>
                                            <option value="medium" selected>Moyenne</option>
                                            <option value="high">Haute</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <div class="mb-3">
                                <label class="form-label">Effort estimé (heures)</label>
                                <input type="number" class="form-control" id="taskEffort" placeholder="Ex: 4" min="0.5" step="0.5">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Deadline</label>
                                <input type="date" class="form-control" id="taskDeadline">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Technologies</label>
                                <input type="text" class="form-control" id="taskTags" placeholder="Ex: React, Node.js">
                                <div class="form-hint">Séparez par des virgules</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn me-auto" data-bs-dismiss="modal">Annuler</button>
                    <button type="button" class="btn btn-primary" onclick="createTask()">
                        <i class="ti ti-plus"></i>
                        Créer la tâche
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- JS Tabler -->
    <script src="https://cdn.jsdelivr.net/npm/@tabler/core@latest/dist/js/tabler.min.js"></script>
    
    <!-- Custom JS -->
    <script src="../assets/js/app.js"></script>
    <script src="../assets/js/auth.js"></script>
    
    <script>
        // Initialisation Kanban
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize user data
            const userData = JSON.parse(localStorage.getItem('currentUser') || '{}');
            if (userData.name) {
                document.getElementById('user-name').textContent = userData.name;
                document.getElementById('user-avatar').style.backgroundImage = `url(${userData.avatar})`;
                document.getElementById('user-avatar-mobile').style.backgroundImage = `url(${userData.avatar})`;
            }
            
            // Initialize Sortable for each column
            ['kanban-todo', 'kanban-inprogress', 'kanban-review', 'kanban-done'].forEach(id => {
                const el = document.getElementById(id);
                if (el) {
                    new Sortable(el, {
                        group: 'shared',
                        animation: 150,
                        dragClass: 'sortable-drag',
                        ghostClass: 'sortable-ghost',
                        onEnd: function(evt) {
                            updateTaskCounts();
                            console.log('Task moved from', evt.from.id, 'to', evt.to.id);
                        }
                    });
                }
            });
            
            // Keyboard shortcuts
            document.addEventListener('keydown', function(e) {
                if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;
                
                switch(e.key.toLowerCase()) {
                    case 't':
                        toggleActiveTimer();
                        e.preventDefault();
                        break;
                    case 'n':
                        addNewTask();
                        e.preventDefault();
                        break;
                    case 'escape':
                        const openModals = document.querySelectorAll('.modal.show');
                        openModals.forEach(modal => {
                            bootstrap.Modal.getInstance(modal)?.hide();
                        });
                        break;
                }
            });
        });
        
        function updateTaskCounts() {
            ['todo', 'inprogress', 'review', 'done'].forEach(status => {
                const count = document.querySelectorAll(`#kanban-${status} .kanban-item`).length;
                const badge = document.getElementById(`count-${status}`);
                if (badge) {
                    badge.textContent = count;
                }
            });
        }
        
        function addNewTask() {
            const modal = new bootstrap.Modal(document.getElementById('modal-new-task'));
            modal.show();
        }
        
        function createTask() {
            console.log('Creating new task...');
            const modal = bootstrap.Modal.getInstance(document.getElementById('modal-new-task'));
            modal.hide();
        }
        
        function startTaskTimer(taskId) {
            console.log('Starting timer for task', taskId);
            document.getElementById('activeTimer').style.display = 'block';
        }
        
        function stopTaskTimer(taskId) {
            console.log('Stopping timer for task', taskId);
        }
        
        function stopTimer() {
            document.getElementById('activeTimer').style.display = 'none';
        }
        
        function toggleActiveTimer() {
            const timer = document.getElementById('activeTimer');
            timer.style.display = timer.style.display === 'none' ? 'block' : 'none';
        }
        
        function editTask(taskId) {
            console.log('Editing task', taskId);
        }
        
        function deleteTask(taskId) {
            console.log('Deleting task', taskId);
        }
        
        function viewReviewComments(taskId) {
            console.log('Viewing review comments for task', taskId);
        }
        
        function showAllCompletedTasks() {
            console.log('Showing all completed tasks');
        }
        
        function filterByMission(missionId) {
            console.log('Filtering by mission', missionId);
        }
        
        function filterByPriority(priority) {
            console.log('Filtering by priority', priority);
        }
    </script>
</body>
</html>