name: DS Guard

on:
  pull_request:
    paths:
      - 'apps/web/**'
      - '!apps/web/**/*.stories.*'
      - '!apps/web/**/*.test.*'

jobs:
  check-inline-styles:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Check for inline styles
        run: |
          echo "üîç Checking for inline styles in apps/web..."
          
          # Check for style= attributes
          if grep -r "style=" apps/web --include="*.tsx" --include="*.jsx" --exclude-dir=node_modules; then
            echo "‚ùå Found inline styles! Use Design System tokens instead."
            exit 1
          fi
          
          # Check for className with hardcoded values (not from DS)
          if grep -rE 'className="[^"]*(?:text-\[|bg-\[|w-\[|h-\[)' apps/web --include="*.tsx" --include="*.jsx" --exclude-dir=node_modules; then
            echo "‚ùå Found hardcoded Tailwind values! Use Design System tokens."
            exit 1
          fi
          
          echo "‚úÖ No inline styles found!"
      
      - name: Check DS imports
        run: |
          echo "üîç Checking that all UI components come from @dainabase/ui..."
          
          # This is a simple check - you might want to make it more sophisticated
          if grep -r "from '@radix-ui" apps/web --include="*.tsx" --include="*.jsx" --exclude-dir=node_modules; then
            echo "‚ö†Ô∏è  Found direct Radix imports! Import from @dainabase/ui instead."
            exit 1
          fi
          
          echo "‚úÖ All UI imports look good!"
