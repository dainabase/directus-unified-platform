<!DOCTYPE html>
<html lang="fr" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SuperAdmin Dashboard - CEO Operations</title>
    
    <!-- Tabler Core CSS -->
    <link href="https://cdn.jsdelivr.net/npm/@tabler/core@1.0.0-beta20/dist/css/tabler.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@tabler/icons@latest/icons-sprite.svg" rel="preload" as="image">
    
    <!-- Inter Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Custom Styles -->
    <style>
        :root {
            /* 60% - Backgrounds */
            --primary-bg: #ffffff;
            --secondary-bg: #f8f9fa;
            
            /* 30% - Elements */
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            
            /* 10% - Accents */
            --accent-blue: #3b82f6;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #06b6d4;
        }

        body {
            font-family: 'Inter', -apple-system, sans-serif;
            font-size: 14px;
            background: var(--secondary-bg);
        }

        /* Dashboard Grid */
        .dashboard-container {
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .dashboard-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 30px;
            background: var(--primary-bg);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        .company-selector {
            min-width: 200px;
        }

        /* CEO Metrics Row */
        .ceo-metrics {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
        }

        .metric-card {
            flex: 1;
            background: var(--primary-bg);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
            border: 1px solid var(--border);
            position: relative;
            min-height: 140px;
        }

        .metric-label {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .metric-value {
            font-size: 32px;
            font-weight: 700;
            line-height: 1.2;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .metric-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 12px;
        }

        .metric-trend {
            font-size: 13px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .metric-trend.positive { color: var(--success); }
        .metric-trend.negative { color: var(--danger); }
        .metric-trend.neutral { color: var(--text-secondary); }

        .metric-sparkline {
            position: absolute;
            right: 20px;
            top: 20px;
            width: 80px;
            height: 40px;
            opacity: 0.7;
        }

        .metric-alert {
            position: absolute;
            top: 12px;
            right: 12px;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--success);
        }

        .metric-alert.critical { background: var(--danger); }
        .metric-alert.warning { background: var(--warning); }

        /* Operational Blocks Grid */
        .operational-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        .operational-block {
            background: var(--primary-bg);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
            border: 1px solid var(--border);
            min-height: 280px;
            max-height: 320px;
            overflow: hidden;
        }

        .block-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border);
        }

        .block-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .block-icon {
            width: 20px;
            height: 20px;
            opacity: 0.7;
        }

        .block-action {
            font-size: 12px;
            color: var(--accent-blue);
            text-decoration: none;
            font-weight: 500;
        }

        .block-action:hover {
            color: var(--accent-blue);
            text-decoration: underline;
        }

        .block-content {
            height: calc(100% - 60px);
            overflow-y: auto;
        }

        .metric-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #f1f5f9;
        }

        .metric-item:last-child {
            border-bottom: none;
        }

        .metric-name {
            font-size: 14px;
            color: var(--text-primary);
            font-weight: 500;
        }

        .metric-detail {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 2px;
        }

        .metric-result {
            text-align: right;
        }

        .metric-number {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .metric-change {
            font-size: 12px;
            font-weight: 500;
            margin-top: 2px;
        }

        .metric-change.positive { color: var(--success); }
        .metric-change.negative { color: var(--danger); }

        /* Company Performance Heat Map */
        .company-row {
            display: flex;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #f1f5f9;
        }

        .company-name {
            flex: 2;
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .company-metric {
            flex: 1;
            text-align: center;
            font-size: 12px;
            font-weight: 600;
            padding: 4px 8px;
            border-radius: 4px;
            margin: 0 2px;
        }

        .status-green { background: #dcfce7; color: #166534; }
        .status-orange { background: #fef3c7; color: #92400e; }
        .status-red { background: #fecaca; color: #991b1b; }

        /* Alert Items */
        .alert-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 10px 0;
            border-bottom: 1px solid #f1f5f9;
        }

        .alert-item:last-child {
            border-bottom: none;
        }

        .alert-icon {
            width: 16px;
            height: 16px;
            margin-top: 2px;
            flex-shrink: 0;
        }

        .alert-icon.danger { color: var(--danger); }
        .alert-icon.warning { color: var(--warning); }
        .alert-icon.info { color: var(--info); }

        .alert-content {
            flex: 1;
        }

        .alert-text {
            font-size: 13px;
            color: var(--text-primary);
            line-height: 1.4;
        }

        .alert-action {
            font-size: 12px;
            color: var(--accent-blue);
            text-decoration: none;
            font-weight: 500;
            margin-left: auto;
            flex-shrink: 0;
        }

        /* Responsive */
        @media (max-width: 992px) {
            .operational-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .ceo-metrics {
                flex-wrap: wrap;
            }
            
            .metric-card {
                min-width: calc(50% - 8px);
            }
        }

        @media (max-width: 768px) {
            .operational-grid {
                grid-template-columns: 1fr;
            }
            
            .ceo-metrics {
                flex-direction: column;
            }
            
            .metric-card {
                min-width: 100%;
            }
            
            .dashboard-header {
                flex-direction: column;
                gap: 15px;
                align-items: stretch;
            }
            
            .metric-value {
                font-size: 24px;
            }
            
            .operational-block {
                min-height: 240px;
            }
        }

        /* Quick Actions */
        .quick-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 12px;
        }

        .quick-action-btn {
            font-size: 12px;
            padding: 6px 12px;
            border-radius: 6px;
            background: var(--secondary-bg);
            color: var(--text-primary);
            text-decoration: none;
            border: 1px solid var(--border);
            transition: all 0.2s;
        }

        .quick-action-btn:hover {
            background: var(--accent-blue);
            color: white;
            border-color: var(--accent-blue);
        }

        /* Progress bars */
        .progress-mini {
            height: 4px;
            background: #f1f5f9;
            border-radius: 2px;
            margin-top: 4px;
            overflow: hidden;
        }

        .progress-bar-mini {
            height: 100%;
            background: var(--accent-blue);
            border-radius: 2px;
            transition: width 0.3s;
        }
    </style>
</head>
<body>
    <div class="page">
        <!-- Sidebar -->
        <aside class="navbar navbar-vertical navbar-expand-lg" data-bs-theme="dark">
            <div class="container-fluid">
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#sidebar-menu" aria-controls="sidebar-menu" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <h1 class="navbar-brand navbar-brand-autodark">
                    <a href=".">
                        SuperAdmin Dashboard V3
                    </a>
                </h1>
                <div class="collapse navbar-collapse" id="sidebar-menu">
                    <div id="sidebar-content"></div>
                </div>
            </div>
        </aside>
        
        <!-- Page wrapper -->
        <div class="page-wrapper">
            <!-- Page header -->
            <div class="page-header d-print-none">
                <div class="container-xl">
                    <div class="row g-2 align-items-center">
                        <div class="col">
                            <h2 class="page-title">CEO Operations Dashboard</h2>
                        </div>
                        <div class="col-auto ms-auto d-print-none">
                            <select class="form-select" id="companyFilter">
                                <option value="all">üìä Vue Consolid√©e</option>
                                <option value="hypervisual">HYPERVISUAL</option>
                                <option value="dainamics">DAINAMICS</option>
                                <option value="lexaia">LEXAIA</option>
                                <option value="enky">ENKY REALTY</option>
                                <option value="takeout">TAKEOUT</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Page body -->
            <div class="page-body">
                <div class="container-xl">
                    <div class="dashboard-container">

        <!-- CEO Metrics Row -->
        <div class="ceo-metrics">
            <!-- Cash Runway -->
            <div class="metric-card">
                <div class="metric-alert" id="cashAlert"></div>
                <div class="metric-sparkline" id="cashSparkline"></div>
                <div class="metric-label">Cash Runway</div>
                <div class="metric-value" id="cashValue">7.3 mois</div>
                <div class="metric-trend positive" id="cashTrend">
                    <svg class="icon icon-tabler" width="14" height="14"><use href="#tabler-arrow-up"></use></svg>
                    +1.2 mois
                </div>
            </div>

            <!-- ARR/MRR -->
            <div class="metric-card">
                <div class="metric-sparkline" id="arrSparkline"></div>
                <div class="metric-label">ARR / MRR</div>
                <div class="metric-value" id="arrValue">‚Ç¨2.4M</div>
                <div class="metric-subtitle" id="mrrValue">‚Ç¨198K MRR</div>
                <div class="metric-trend positive" id="arrTrend">
                    <svg class="icon icon-tabler" width="14" height="14"><use href="#tabler-arrow-up"></use></svg>
                    +23% YoY
                </div>
            </div>

            <!-- EBITDA Margin -->
            <div class="metric-card">
                <div class="metric-sparkline" id="ebitdaSparkline"></div>
                <div class="metric-label">EBITDA Margin</div>
                <div class="metric-value" id="ebitdaValue">18.5%</div>
                <div class="metric-subtitle">Target: 20%</div>
                <div class="metric-trend positive" id="ebitdaTrend">
                    <svg class="icon icon-tabler" width="14" height="14"><use href="#tabler-arrow-up"></use></svg>
                    +2.3%
                </div>
            </div>

            <!-- LTV:CAC -->
            <div class="metric-card">
                <div class="metric-sparkline" id="ltvCacSparkline"></div>
                <div class="metric-label">LTV:CAC Ratio</div>
                <div class="metric-value" id="ltvCacValue">4.2:1</div>
                <div class="metric-subtitle">Healthy > 3:1</div>
                <div class="metric-trend positive" id="ltvCacStatus">Excellent</div>
            </div>

            <!-- NPS Global -->
            <div class="metric-card">
                <div class="metric-sparkline" id="npsSparkline"></div>
                <div class="metric-label">NPS Global</div>
                <div class="metric-value" id="npsValue">72</div>
                <div class="metric-subtitle">Excellent</div>
                <div class="metric-trend positive" id="npsTrend">
                    <svg class="icon icon-tabler" width="14" height="14"><use href="#tabler-arrow-up"></use></svg>
                    +5
                </div>
            </div>
        </div>

        <!-- Operational Blocks Grid -->
        <div class="operational-grid">
            <!-- BLOC 1: Finance & Tr√©sorerie -->
            <div class="operational-block">
                <div class="block-header">
                    <div class="block-title">
                        <svg class="block-icon icon icon-tabler"><use href="#tabler-currency-euro"></use></svg>
                        Finance & Tr√©sorerie
                    </div>
                    <a href="#" class="block-action">D√©tails</a>
                </div>
                <div class="block-content">
                    <div class="metric-item">
                        <div>
                            <div class="metric-name">Cash Disponible</div>
                            <div class="metric-detail">Toutes banques</div>
                        </div>
                        <div class="metric-result">
                            <div class="metric-number">‚Ç¨847K</div>
                        </div>
                    </div>
                    <div class="metric-item">
                        <div>
                            <div class="metric-name">Factures Impay√©es</div>
                            <div class="metric-detail">12 factures en attente</div>
                        </div>
                        <div class="metric-result">
                            <div class="metric-number">‚Ç¨45K</div>
                            <div class="metric-change negative">3 > 60j</div>
                        </div>
                    </div>
                    <div class="metric-item">
                        <div>
                            <div class="metric-name">Paiements Dus</div>
                            <div class="metric-detail">8 factures √† payer</div>
                        </div>
                        <div class="metric-result">
                            <div class="metric-number">‚Ç¨127K</div>
                            <div class="metric-change neutral">Sous 30j</div>
                        </div>
                    </div>
                    <div class="metric-item">
                        <div>
                            <div class="metric-name">CA du Mois</div>
                            <div class="metric-detail">Objectif: ‚Ç¨220K</div>
                            <div class="progress-mini">
                                <div class="progress-bar-mini" style="width: 90%"></div>
                            </div>
                        </div>
                        <div class="metric-result">
                            <div class="metric-number">‚Ç¨198K</div>
                            <div class="metric-change positive">90%</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- BLOC 2: T√¢ches & Op√©rationnel -->
            <div class="operational-block">
                <div class="block-header">
                    <div class="block-title">
                        <svg class="block-icon icon icon-tabler"><use href="#tabler-clipboard-list"></use></svg>
                        T√¢ches & Op√©rationnel
                    </div>
                    <a href="#" class="block-action">Voir tout</a>
                </div>
                <div class="block-content">
                    <div class="metric-item">
                        <div>
                            <div class="metric-name">T√¢ches Aujourd'hui</div>
                            <div class="metric-detail">√Ä finaliser</div>
                        </div>
                        <div class="metric-result">
                            <div class="metric-number">14</div>
                        </div>
                    </div>
                    <div class="metric-item">
                        <div>
                            <div class="metric-name">T√¢ches en Retard</div>
                            <div class="metric-detail">1 critique</div>
                        </div>
                        <div class="metric-result">
                            <div class="metric-number">3</div>
                            <div class="metric-change negative">Urgent</div>
                        </div>
                    </div>
                    <div class="metric-item">
                        <div>
                            <div class="metric-name">Projets Actifs</div>
                            <div class="metric-detail">En cours</div>
                        </div>
                        <div class="metric-result">
                            <div class="metric-number">8</div>
                        </div>
                    </div>
                    <div class="metric-item">
                        <div>
                            <div class="metric-name">Actions Urgentes</div>
                            <div class="metric-detail">
                                ‚Ä¢ Valider devis BNP<br>
                                ‚Ä¢ Call client Hypervisual
                            </div>
                        </div>
                        <div class="metric-result">
                            <div class="metric-number">2</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- BLOC 3: Commercial & Ventes -->
            <div class="operational-block">
                <div class="block-header">
                    <div class="block-title">
                        <svg class="block-icon icon icon-tabler"><use href="#tabler-target"></use></svg>
                        Commercial & Ventes
                    </div>
                    <a href="#" class="block-action">Pipeline</a>
                </div>
                <div class="block-content">
                    <div class="metric-item">
                        <div>
                            <div class="metric-name">Pipeline Total</div>
                            <div class="metric-detail">24 opportunit√©s</div>
                        </div>
                        <div class="metric-result">
                            <div class="metric-number">‚Ç¨1.2M</div>
                        </div>
                    </div>
                    <div class="metric-item">
                        <div>
                            <div class="metric-name">Devis Actifs</div>
                            <div class="metric-detail">7 en attente r√©ponse</div>
                        </div>
                        <div class="metric-result">
                            <div class="metric-number">‚Ç¨340K</div>
                        </div>
                    </div>
                    <div class="metric-item">
                        <div>
                            <div class="metric-name">Taux Conversion</div>
                            <div class="metric-detail">vs mois dernier</div>
                        </div>
                        <div class="metric-result">
                            <div class="metric-number">32%</div>
                            <div class="metric-change positive">+4%</div>
                        </div>
                    </div>
                    <div class="metric-item">
                        <div>
                            <div class="metric-name">RDV Pr√©vus</div>
                            <div class="metric-detail">Cette semaine</div>
                        </div>
                        <div class="metric-result">
                            <div class="metric-number">5</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- BLOC 4: Marketing & Trafic -->
            <div class="operational-block">
                <div class="block-header">
                    <div class="block-title">
                        <svg class="block-icon icon icon-tabler"><use href="#tabler-chart-line"></use></svg>
                        Marketing & Trafic
                    </div>
                    <a href="#" class="block-action">Analytics</a>
                </div>
                <div class="block-content">
                    <div class="metric-item">
                        <div>
                            <div class="metric-name">Visiteurs Aujourd'hui</div>
                            <div class="metric-detail">Tous sites</div>
                        </div>
                        <div class="metric-result">
                            <div class="metric-number">1,847</div>
                        </div>
                    </div>
                    <div class="metric-item">
                        <div>
                            <div class="metric-name">Leads Semaine</div>
                            <div class="metric-detail">Qualifi√©s</div>
                        </div>
                        <div class="metric-result">
                            <div class="metric-number">124</div>
                            <div class="metric-change positive">+18%</div>
                        </div>
                    </div>
                    <div class="metric-item">
                        <div>
                            <div class="metric-name">Conversion Web</div>
                            <div class="metric-detail">Moyenne mobile</div>
                        </div>
                        <div class="metric-result">
                            <div class="metric-number">6.7%</div>
                        </div>
                    </div>
                    <div class="metric-item">
                        <div>
                            <div class="metric-name">Top Sources</div>
                            <div class="metric-detail">
                                Google: 45% ‚Ä¢ Direct: 30% ‚Ä¢ Social: 25%
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- BLOC 5: Performance Entreprises -->
            <div class="operational-block">
                <div class="block-header">
                    <div class="block-title">
                        <svg class="block-icon icon icon-tabler"><use href="#tabler-building"></use></svg>
                        Performance Entreprises
                    </div>
                    <a href="#" class="block-action">Heat Map</a>
                </div>
                <div class="block-content">
                    <div class="company-row">
                        <div class="company-name">HYPERVISUAL</div>
                        <div class="company-metric status-green">‚Ç¨67K</div>
                        <div class="company-metric status-green">22%</div>
                    </div>
                    <div class="company-row">
                        <div class="company-name">DAINAMICS</div>
                        <div class="company-metric status-green">‚Ç¨89K</div>
                        <div class="company-metric status-green">31%</div>
                    </div>
                    <div class="company-row">
                        <div class="company-name">LEXAIA</div>
                        <div class="company-metric status-orange">‚Ç¨12K</div>
                        <div class="company-metric status-orange">8%</div>
                    </div>
                    <div class="company-row">
                        <div class="company-name">ENKY REALTY</div>
                        <div class="company-metric status-green">‚Ç¨24K</div>
                        <div class="company-metric status-green">15%</div>
                    </div>
                    <div class="company-row">
                        <div class="company-name">TAKEOUT</div>
                        <div class="company-metric status-red">‚Ç¨6K</div>
                        <div class="company-metric status-red">-12%</div>
                    </div>
                </div>
            </div>

            <!-- BLOC 6: Alertes & Actions -->
            <div class="operational-block">
                <div class="block-header">
                    <div class="block-title">
                        <svg class="block-icon icon icon-tabler"><use href="#tabler-alert-triangle"></use></svg>
                        Alertes & Actions
                    </div>
                    <a href="#" class="block-action">Toutes</a>
                </div>
                <div class="block-content">
                    <div class="alert-item">
                        <svg class="alert-icon danger icon icon-tabler"><use href="#tabler-alert-circle"></use></svg>
                        <div class="alert-content">
                            <div class="alert-text">3 factures impay√©es > 60 jours</div>
                        </div>
                        <a href="#" class="alert-action">Voir</a>
                    </div>
                    <div class="alert-item">
                        <svg class="alert-icon warning icon icon-tabler"><use href="#tabler-alert-triangle"></use></svg>
                        <div class="alert-content">
                            <div class="alert-text">Cash runway < 6 mois pour TAKEOUT</div>
                        </div>
                        <a href="#" class="alert-action">Analyser</a>
                    </div>
                    <div class="alert-item">
                        <svg class="alert-icon info icon icon-tabler"><use href="#tabler-info-circle"></use></svg>
                        <div class="alert-content">
                            <div class="alert-text">5 devis expirent cette semaine</div>
                        </div>
                        <a href="#" class="alert-action">Relancer</a>
                    </div>
                    
                    <div class="quick-actions">
                        <a href="#" class="quick-action-btn">Nouvelle facture</a>
                        <a href="#" class="quick-action-btn">Nouveau projet</a>
                        <a href="#" class="quick-action-btn">Voir rapport</a>
                    </div>
                </div>
            </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Tabler Icons -->
    <script src="https://cdn.jsdelivr.net/npm/@tabler/core@1.0.0-beta20/dist/js/tabler.min.js"></script>
    
    <!-- ApexCharts -->
    <script src="https://cdn.jsdelivr.net/npm/apexcharts@latest/dist/apexcharts.min.js"></script>
    
    <!-- Load Sidebar V3 -->
    <script>
        fetch('sidebar-v3.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('sidebar-content').innerHTML = html;
            })
            .catch(error => console.error('Error loading sidebar:', error));
    </script>
    
    <!-- SuperAdmin V3 Logic -->
    <script src="assets/js/superadmin-v3.js"></script>
    
    <!-- Legacy compatibility bridge -->
    <script>
        class SuperAdminDashboard {
            constructor() {
                this.currentCompany = 'all';
                this.charts = {};
                this.refreshInterval = 30000; // 30 seconds
                
                this.init();
            }
            
            init() {
                this.initializeSparklines();
                this.bindEvents();
                this.loadData();
                this.startAutoRefresh();
                
                console.log('üöÄ SuperAdmin Dashboard initialized');
            }
            
            initializeSparklines() {
                // Cash Runway Sparkline
                this.createSparkline('cashSparkline', {
                    data: [6.1, 5.8, 6.2, 6.8, 7.1, 7.3],
                    color: '#10b981'
                });
                
                // ARR Sparkline
                this.createSparkline('arrSparkline', {
                    data: [1.8, 1.9, 2.0, 2.1, 2.3, 2.4],
                    color: '#3b82f6'
                });
                
                // EBITDA Sparkline
                this.createSparkline('ebitdaSparkline', {
                    data: [15.2, 16.1, 17.3, 17.8, 18.1, 18.5],
                    color: '#8b5cf6'
                });
                
                // LTV:CAC Sparkline
                this.createSparkline('ltvCacSparkline', {
                    data: [3.1, 3.4, 3.8, 4.0, 4.1, 4.2],
                    color: '#06b6d4'
                });
                
                // NPS Sparkline
                this.createSparkline('npsSparkline', {
                    data: [65, 67, 69, 70, 71, 72],
                    color: '#f59e0b'
                });
            }
            
            createSparkline(elementId, config) {
                const element = document.getElementById(elementId);
                if (!element) return;
                
                const options = {
                    series: [{
                        data: config.data
                    }],
                    chart: {
                        type: 'line',
                        height: 40,
                        sparkline: { enabled: true },
                        animations: { enabled: false }
                    },
                    stroke: { 
                        width: 2, 
                        curve: 'smooth' 
                    },
                    colors: [config.color],
                    tooltip: { enabled: false }
                };
                
                this.charts[elementId] = new ApexCharts(element, options);
                this.charts[elementId].render();
            }
            
            bindEvents() {
                // Company filter
                document.getElementById('companyFilter').addEventListener('change', (e) => {
                    this.currentCompany = e.target.value;
                    this.filterByCompany(this.currentCompany);
                });
            }
            
            loadData() {
                // Simulate data loading
                this.updateMetrics();
                this.updateOperationalBlocks();
                
                console.log('üìä Data loaded for company:', this.currentCompany);
            }
            
            updateMetrics() {
                const data = this.getMetricsData(this.currentCompany);
                
                // Update Cash Runway
                document.getElementById('cashValue').textContent = data.cashRunway;
                const cashAlert = document.getElementById('cashAlert');
                cashAlert.className = `metric-alert ${data.cashAlert}`;
                
                // Update ARR/MRR
                document.getElementById('arrValue').textContent = data.arr;
                document.getElementById('mrrValue').textContent = data.mrr;
                
                // Update EBITDA
                document.getElementById('ebitdaValue').textContent = data.ebitda;
                
                // Update LTV:CAC
                document.getElementById('ltvCacValue').textContent = data.ltvCac;
                
                // Update NPS
                document.getElementById('npsValue').textContent = data.nps;
            }
            
            updateOperationalBlocks() {
                // Update operational data based on selected company
                console.log('üîÑ Updating operational blocks for:', this.currentCompany);
            }
            
            getMetricsData(company) {
                const data = {
                    all: {
                        cashRunway: '7.3 mois',
                        cashAlert: 'warning',
                        arr: '‚Ç¨2.4M',
                        mrr: '‚Ç¨198K MRR',
                        ebitda: '18.5%',
                        ltvCac: '4.2:1',
                        nps: '72'
                    },
                    hypervisual: {
                        cashRunway: '9.2 mois',
                        cashAlert: '',
                        arr: '‚Ç¨680K',
                        mrr: '‚Ç¨56K MRR',
                        ebitda: '22.1%',
                        ltvCac: '5.1:1',
                        nps: '78'
                    },
                    dainamics: {
                        cashRunway: '12.1 mois',
                        cashAlert: '',
                        arr: '‚Ç¨890K',
                        mrr: '‚Ç¨74K MRR',
                        ebitda: '31.2%',
                        ltvCac: '6.2:1',
                        nps: '84'
                    },
                    lexaia: {
                        cashRunway: '4.1 mois',
                        cashAlert: 'warning',
                        arr: '‚Ç¨145K',
                        mrr: '‚Ç¨12K MRR',
                        ebitda: '8.3%',
                        ltvCac: '2.1:1',
                        nps: '58'
                    },
                    enky: {
                        cashRunway: '8.7 mois',
                        cashAlert: '',
                        arr: '‚Ç¨310K',
                        mrr: '‚Ç¨26K MRR',
                        ebitda: '15.8%',
                        ltvCac: '3.8:1',
                        nps: '71'
                    },
                    takeout: {
                        cashRunway: '2.1 mois',
                        cashAlert: 'critical',
                        arr: '‚Ç¨89K',
                        mrr: '‚Ç¨7K MRR',
                        ebitda: '-12.1%',
                        ltvCac: '1.3:1',
                        nps: '42'
                    }
                };
                
                return data[company] || data.all;
            }
            
            filterByCompany(company) {
                this.updateMetrics();
                this.updateOperationalBlocks();
                
                // Update sparklines with company-specific data
                this.updateSparklines(company);
                
                console.log(`üè¢ Filtered to company: ${company}`);
            }
            
            updateSparklines(company) {
                // Update sparkline data based on company
                const sparklineData = this.getSparklineData(company);
                
                Object.keys(this.charts).forEach(chartId => {
                    if (sparklineData[chartId]) {
                        this.charts[chartId].updateSeries([{
                            data: sparklineData[chartId]
                        }]);
                    }
                });
            }
            
            getSparklineData(company) {
                // Return company-specific sparkline data
                const data = {
                    all: {
                        cashSparkline: [6.1, 5.8, 6.2, 6.8, 7.1, 7.3],
                        arrSparkline: [1.8, 1.9, 2.0, 2.1, 2.3, 2.4],
                        ebitdaSparkline: [15.2, 16.1, 17.3, 17.8, 18.1, 18.5],
                        ltvCacSparkline: [3.1, 3.4, 3.8, 4.0, 4.1, 4.2],
                        npsSparkline: [65, 67, 69, 70, 71, 72]
                    },
                    hypervisual: {
                        cashSparkline: [8.1, 8.4, 8.7, 8.9, 9.0, 9.2],
                        arrSparkline: [0.58, 0.61, 0.64, 0.66, 0.67, 0.68],
                        ebitdaSparkline: [19.2, 20.1, 21.3, 21.8, 22.0, 22.1],
                        ltvCacSparkline: [4.1, 4.4, 4.8, 5.0, 5.1, 5.1],
                        npsSparkline: [72, 74, 75, 76, 77, 78]
                    }
                    // Add more company data as needed...
                };
                
                return data[company] || data.all;
            }
            
            startAutoRefresh() {
                setInterval(() => {
                    this.loadData();
                }, this.refreshInterval);
                
                console.log(`‚è±Ô∏è Auto-refresh started (${this.refreshInterval/1000}s)`);
            }
        }
        
        // Initialize dashboard (legacy compatibility)
        document.addEventListener('DOMContentLoaded', () => {
            // V3 Dashboard is initialized by superadmin-v3.js
            // This is kept for backward compatibility
            if (!window.superAdminDashboard) {
                window.dashboard = new SuperAdminDashboard();
            }
        });
    </script>
</body>
</html>